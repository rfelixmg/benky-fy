<!-- Floating Settings Modal -->
<div class="settings-modal" id="settingsModal">
	<div class="settings-modal-content">
		<div class="settings-modal-header">
			<h2>Settings</h2>
			<button class="settings-close-btn" onclick="toggleSettings()" title="Close">‚úï</button>
		</div>
		<div class="settings-body">
			<!-- Flashcard Display Mode Section -->
			<div class="settings-section">
				<div class="settings-section-header" onclick="toggleSection('flashcard-display')">
					<h3>Flashcard Display Mode</h3>
					<span class="section-toggle">‚ñº</span>
				</div>
				<div class="settings-section-content" id="flashcard-display">
					<div class="radio-group">
						<label class="radio-option">
							<input type="radio" name="display_mode" value="kana" checked onchange="handleDisplayModeChange('kana')">
							<span>Kana</span>
						</label>
						<label class="radio-option">
							<input type="radio" name="display_mode" value="kanji" onchange="handleDisplayModeChange('kanji')">
							<span>Kanji</span>
						</label>
						<label class="radio-option">
							<input type="radio" name="display_mode" value="kanji_furigana" onchange="handleDisplayModeChange('kanji_furigana')">
							<span>Kanji + Furigana</span>
						</label>
						<label class="radio-option">
							<input type="radio" name="display_mode" value="english" onchange="handleDisplayModeChange('english')">
							<span>English</span>
						</label>
						<label class="radio-option">
							<input type="radio" name="display_mode" value="weighted" onchange="handleDisplayModeChange('weighted')">
							<span>üîÑ Weighted Display</span>
						</label>
					</div>
					
					<!-- Kana Sub-toggle -->
					<div class="kana-toggle-panel" id="kana-toggle-panel" style="display: block;">
						<h4>Kana Type</h4>
						<div class="radio-group kana-sub-group">
							<label class="radio-option">
								<input type="radio" name="kana_type" value="hiragana" checked onchange="handleKanaTypeChange('hiragana')">
								<span>Hiragana</span>
							</label>
							<label class="radio-option">
								<input type="radio" name="kana_type" value="katakana" onchange="handleKanaTypeChange('katakana')">
								<span>Katakana</span>
							</label>
						</div>
					</div>
					
					<!-- Furigana Style Sub-panel (for Kanji + Furigana) -->
					<div class="weighted-panel" id="furigana-style-panel" style="display: none;">
						<h4>Furigana Style</h4>
					<label class="select-label">
							<span>Furigana Style</span>
							<select id="furigana-style" onchange="handleFuriganaStyleChange(this.value)">
								<option value="hover">Hover (tooltip on kanji)</option>
								<option value="inline">Inline (above or beside)</option>
								<option value="brackets">Brackets (e.g., È£ü[„Åü]„Åπ„Çã)</option>
								<option value="ruby" selected>Ruby (default browser <ruby>)</option>
						</select>
					</label>
					</div>
					
					<!-- Weighted Display Sub-panel -->
					<div class="weighted-panel" id="weighted-panel" style="display: none;">
						<h4>Display Weights</h4>
						<div class="slider-group">
							<label class="slider-label">
								<span>Kana</span>
								<input type="range" min="0" max="1" step="0.1" value="0.3" class="weight-slider" data-type="kana">
								<span class="slider-value">0.3</span>
							</label>
							<label class="slider-label">
								<span>Kanji</span>
								<input type="range" min="0" max="1" step="0.1" value="0.3" class="weight-slider" data-type="kanji">
								<span class="slider-value">0.3</span>
							</label>
							<label class="slider-label">
								<span>Kanji + Furigana</span>
								<input type="range" min="0" max="1" step="0.1" value="0.2" class="weight-slider" data-type="kanji_furigana">
								<span class="slider-value">0.2</span>
							</label>
							<label class="slider-label">
								<span>English</span>
								<input type="range" min="0" max="1" step="0.1" value="0.2" class="weight-slider" data-type="english">
								<span class="slider-value">0.2</span>
					</label>
						</div>
					</div>
				</div>
			</div>

			<!-- Answer Input Mode Section -->
			<div class="settings-section">
				<div class="settings-section-header" onclick="toggleSection('answer-input')">
					<h3>Answer Input Mode</h3>
					<span class="section-toggle">‚ñº</span>
				</div>
				<div class="settings-section-content" id="answer-input">
					<div class="checkbox-group">
						<label class="checkbox-option">
							<input type="checkbox" name="input_modes" value="hiragana" checked onchange="handleInputModeChange()">
							<span>Hiragana (romaji input ‚Üí auto-converts to kana)</span>
						</label>
						<label class="checkbox-option">
							<input type="checkbox" name="input_modes" value="romaji" onchange="handleInputModeChange()">
							<span>Romaji (as typed)</span>
						</label>
						<label class="checkbox-option">
							<input type="checkbox" name="input_modes" value="katakana" onchange="handleInputModeChange()">
							<span>Katakana</span>
						</label>
						<label class="checkbox-option">
							<input type="checkbox" name="input_modes" value="kanji" onchange="handleInputModeChange()">
							<span>Kanji</span>
						</label>
						<label class="checkbox-option">
							<input type="checkbox" name="input_modes" value="english" onchange="handleInputModeChange()">
							<span>English</span>
					</label>
					</div>
					<div class="helper-text">
						<p>You can select more than one. Your answer will be accepted if it matches any selected type.</p>
					</div>
				</div>
			</div>

			
			<div class="settings-actions">
				<button type="button" class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
				<button type="button" class="btn btn-secondary" onclick="resetToDefaults()">Reset to Defaults</button>
			</div>
		</div>
	</div>
</div>
